var startTime = new Date; h = (startTime.getHours() < 10 ? "0" : "") + startTime.getHours(), m = (startTime.getMinutes() < 10 ? "0" : "") + startTime.getMinutes(); var st = h + ":" + m; window.onbeforeunload = function () { var t = new Date; h2 = (t.getHours() < 10 ? "0" : "") + t.getHours(), m2 = (t.getMinutes() < 10 ? "0" : "") + t.getMinutes(); var e = h2 + ":" + m2, s = JSON.stringify({ from: st, to: e }), n = new XMLHttpRequest; n.onreadystatechange = function () { 4 == this.readyState && 200 == this.status && console.log("sending") }, n.open("POST", "http://localhost:8888/visitdata", !0), n.setRequestHeader("Content-type", "application/json"), n.send(s) };